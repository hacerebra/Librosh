<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Librosh | Kayıt</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="icon" type="image/svg+xml" href="assets/icons/favicon.svg">
  <link href="https://fonts.googleapis.com/css2?family=Bitcount+Grid+Double:wght@100..900&family=Manufacturing+Consent&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
</head>
<body>
    <div class="register-container">
      <div class="form-section">
        <div class="logo">
          <img src="assets/icons/logo.png" alt="Librosh Logo" style="height: 51px; vertical-align: middle;">
        </div>
        <h2 class="form-title">Kayıt Ol</h2>
        <form class="register-form">
            <div class="input-wrapper">
                <label for="username">Kullanıcı adı</label>
                <input type="text" id="username" placeholder="Kullanıcı adı" />
              </div>
              
            <div class="input-wrapper">
                <label for="dob">Doğum Tarihi</label>
                <input type="date" id="dob" placeholder="gg.aa.yyyy"/>
              </div>

            <div class="input-wrapper">
              <label for="gender">Cinsiyet</label>
              <select id="gender">
                <option value="">Seçiniz</option>
                <option value="Kadın">Kadın</option>
                <option value="Erkek">Erkek</option>
                <option value="Diğer">Diğer</option>
              </select>
              </div>

            <div class="input-wrapper">
                <label for="email">E-mail</label>
                <input type="email" id="email" placeholder="ex@example.com" />
              </div>
              <div class="input-wrapper">
                <label for="password">Şifre</label>
                <input type="password" id="password" placeholder="********" />
                <img src="assets/icons/eye.svg" alt="Göster" id="togglePassword1" style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); cursor: pointer;" />
              </div>   
              
              <div class="input-wrapper">
                <label for="password2">Şifre Tekrar</label>
                <input type="password" id="password2" placeholder="********" />
                <img src="assets/icons/eye.svg" alt="Göster" id="togglePassword2" style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); cursor: pointer;" />
              </div>   
              
  
          <button type="submit" class="register-button">Kayıt Ol</button>
        </form>
        <nav class="menu">
            <a href="index.html" class="link-button"
              onmouseenter="this.querySelector('img').src='assets/icons/home-light.svg'"
              onmouseleave="this.querySelector('img').src='assets/icons/home.svg'">
              <img src="assets/icons/home.svg" alt="Edit İkonu" width="16" height="16">
              Ana Sayfa
            </a>
            <a href="kitaplar.html" class="link-button"
              onmouseenter="this.querySelector('img').src='assets/icons/categories-light.svg'"
              onmouseleave="this.querySelector('img').src='assets/icons/categories.svg'">
              <img src="assets/icons/categories.svg" alt="Kategoriler İkonu" width="16" height="16">
              Kategoriler
            </a>
            <a href="kullanıcı-giris.html" class="link-button"
              onmouseenter="this.querySelector('img').src='assets/icons/enter-light.svg'"
              onmouseleave="this.querySelector('img').src='assets/icons/enter.svg'">
              <img src="assets/icons/enter.svg" alt="Giriş İkonu" width="16" height="16">
              Giriş Yap
            </a>
          </nav>
      </div>
      <div class="image-section">
        <img src="assets/images/bilgisayar.png" alt="Kayıt Görseli">
      </div>
    </div>

    <div id="customAlert" class="custom-alert">
      <div class="alert-box">
        <h3 class="alert-title">Bilgilendirme</h3>
        <p id="alertMessage"></p>
        <button onclick="closeCustomAlert()">Tamam</button>
      </div>
    </div>
  </div>

    <script>

const togglePassword1 = document.getElementById('togglePassword1');
const passwordInput1 = document.getElementById('password');

togglePassword1.addEventListener('click', function () {
  const isPassword = passwordInput1.type === 'password';
  passwordInput1.type = isPassword ? 'text' : 'password';
  this.src = isPassword ? 'assets/icons/eye-off.svg' : 'assets/icons/eye.svg';
  this.alt = isPassword ? 'Gizle' : 'Göster';
});

const togglePassword2 = document.getElementById('togglePassword2');
const passwordInput2 = document.getElementById('password2');

togglePassword2.addEventListener('click', function () {
  const isPassword = passwordInput2.type === 'password';
  passwordInput2.type = isPassword ? 'text' : 'password';
  this.src = isPassword ? 'assets/icons/eye-off.svg' : 'assets/icons/eye.svg';
  this.alt = isPassword ? 'Gizle' : 'Göster';
});


  const genderSelect = document.getElementById('gender');

  function updateSelectColor() {
    genderSelect.style.color = genderSelect.value === "" ? "#C0C0C0" : "#4C4D7A";
  }

  // İlk açılışta kontrol et
  window.addEventListener('load', updateSelectColor);

  // Değişince tekrar kontrol et
  genderSelect.addEventListener('change', updateSelectColor);


     
      document.querySelector('.register-form').addEventListener('submit', function(e) {
        e.preventDefault();
      
        const username = document.getElementById('username').value.trim();
        const dob = document.getElementById('dob').value.trim();
        const gender = document.getElementById('gender').value.trim();
        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('password').value;
        const password2 = document.getElementById('password2').value;
      
        if (!username || !dob || !gender || !email || !password || !password2) {
          showCustomAlert("Lütfen tüm alanları doldurun.");
          return;
        }

        const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$/;

        if (password !== password2) {
          showCustomAlert("Şifreler uyuşmuyor.");
          return;
        }

        if(!passwordRegex.test(password)) {
          showCustomAlert("Şifre en az 8 karakter olmalı ve büyük harf, küçük harf, rakam ve özel karakter içermelidir.");
          return;
        }

      
        // Kullanıcı listesi varsa çek, yoksa boş array başlat
        let users = JSON.parse(localStorage.getItem("users")) || [];
      
        // Aynı e-posta var mı kontrol et
        if (users.some(user => user.email === email)) {
          showCustomAlert("Bu e-posta ile zaten kayıt olunmuş.");
          return;
        }
      
        // Yeni kullanıcıyı ekle
        users.push({ username, dob, gender, email, password });
        localStorage.setItem("users", JSON.stringify(users));

        showCustomAlert("Kayıt başarılı! Giriş sayfasına yönlendiriliyorsunuz.");
        setTimeout(() => {
        window.location.href = "kullanıcı-giris.html";
        }, 3000);
      });

      const dateInput = document.getElementById('dob');
      dateInput.addEventListener('input', function () {
        if (this.value) {
          this.classList.add('filled');
        } else {
          this.classList.remove('filled');
        }
      });

      </script>
      <script src="script.js"></script>
      <script src="alert.js"></script>
      
  </body>
  </html>